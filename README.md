# historical-distance-win-probability-experiment

## Getting Started

1. `npm i`
1. `npm start` for movement graph
1. `npm backtestCLI` for cli to test distances and premiums
1. `npm backtestAllScenarios` to run the present distances and static premiums against the provided data.

## Data

10 year download from NASDAQ

https://www.nasdaq.com/market-activity/index/spx/historical

## Results

```
Loss per losing trade: 25%
┌─────────┬──────────┬─────────┬───────────┬──────────┬───────────┬─────────┐
│ (index) │ distance │ maxLoss │ maxProfit │ winCount │ lossCount │ balance │
├─────────┼──────────┼─────────┼───────────┼──────────┼───────────┼─────────┤
│    0    │    50    │   490   │    10     │   1024   │    16     │  9788   │
│    1    │    45    │   485   │    15     │   1019   │    21     │  14244  │
│    2    │    40    │   480   │    20     │   1010   │    30     │  18100  │
│    3    │    35    │   465   │    35     │   1002   │    38     │  32162  │
│    4    │    30    │   445   │    55     │   982    │    58     │  49072  │
│    5    │    25    │   425   │    75     │   964    │    76     │  65744  │
│    6    │    20    │   390   │    110    │   922    │    118    │  91474  │
│    7    │    15    │   340   │    160    │   856    │    184    │ 122820  │
│    8    │    10    │   305   │    195    │   782    │    258    │ 134382  │
│    9    │    5     │   260   │    240    │   649    │    391    │ 131845  │
│   10    │    -5    │   325   │    175    │   727    │    313    │ 103372  │
│   11    │   -10    │   360   │    140    │   821    │    219    │  96730  │
│   12    │   -15    │   390   │    110    │   894    │    146    │  85678  │
│   13    │   -20    │   420   │    80     │   932    │    108    │  64720  │
│   14    │   -25    │   435   │    65     │   966    │    74     │  56298  │
│   15    │   -30    │   445   │    55     │   989    │    51     │  50234  │
│   16    │   -35    │   465   │    35     │   998    │    42     │  31558  │
│   17    │   -40    │   465   │    35     │   1009   │    31     │  33219  │
│   18    │   -45    │   475   │    25     │   1016   │    24     │  24068  │
│   19    │   -50    │   480   │    20     │   1023   │    17     │  19920  │
└─────────┴──────────┴─────────┴───────────┴──────────┴───────────┴─────────┘
Loss per losing trade: 50%
┌─────────┬──────────┬─────────┬───────────┬──────────┬───────────┬─────────┐
│ (index) │ distance │ maxLoss │ maxProfit │ winCount │ lossCount │ balance │
├─────────┼──────────┼─────────┼───────────┼──────────┼───────────┼─────────┤
│    0    │    50    │   490   │    10     │   1024   │    16     │  7820   │
│    1    │    45    │   485   │    15     │   1019   │    21     │  11703  │
│    2    │    40    │   480   │    20     │   1010   │    30     │  14500  │
│    3    │    35    │   465   │    35     │   1002   │    38     │  27754  │
│    4    │    30    │   445   │    55     │   982    │    58     │  42634  │
│    5    │    25    │   425   │    75     │   964    │    76     │  57688  │
│    6    │    20    │   390   │    110    │   922    │    118    │  79910  │
│    7    │    15    │   340   │    160    │   856    │    184    │ 107180  │
│    8    │    10    │   305   │    195    │   782    │    258    │ 114774  │
│    9    │    5     │   260   │    240    │   649    │    391    │ 106430  │
│   10    │    -5    │   325   │    175    │   727    │    313    │  78019  │
│   11    │   -10    │   360   │    140    │   821    │    219    │  77020  │
│   12    │   -15    │   390   │    110    │   894    │    146    │  71370  │
│   13    │   -20    │   420   │    80     │   932    │    108    │  53380  │
│   14    │   -25    │   435   │    65     │   966    │    74     │  48232  │
│   15    │   -30    │   445   │    55     │   989    │    51     │  44573  │
│   16    │   -35    │   465   │    35     │   998    │    42     │  26686  │
│   17    │   -40    │   465   │    35     │   1009   │    31     │  29623  │
│   18    │   -45    │   475   │    25     │   1016   │    24     │  21212  │
│   19    │   -50    │   480   │    20     │   1023   │    17     │  17880  │
└─────────┴──────────┴─────────┴───────────┴──────────┴───────────┴─────────┘
Loss per losing trade: 75%
┌─────────┬──────────┬─────────┬───────────┬──────────┬───────────┬─────────┬────────────────┐
│ (index) │ distance │ maxLoss │ maxProfit │ winCount │ lossCount │ balance │ unableToFinish │
├─────────┼──────────┼─────────┼───────────┼──────────┼───────────┼─────────┼────────────────┤
│    0    │    50    │   490   │    10     │   1024   │    16     │  5868   │                │
│    1    │    45    │   485   │    15     │   1019   │    21     │  9162   │                │
│    2    │    40    │   480   │    20     │   1010   │    30     │  10900  │                │
│    3    │    35    │   465   │    35     │   1002   │    38     │  23346  │                │
│    4    │    30    │   445   │    55     │   982    │    58     │  36196  │                │
│    5    │    25    │   425   │    75     │   964    │    76     │  49632  │                │
│    6    │    20    │   390   │    110    │   922    │    118    │  68464  │                │
│    7    │    15    │   340   │    160    │   856    │    184    │  91540  │                │
│    8    │    10    │   305   │    195    │   782    │    258    │  95166  │                │
│    9    │    5     │   260   │    240    │   649    │    391    │  81015  │                │
│   10    │    -5    │   325   │    175    │   727    │    313    │  52666  │                │
│   11    │   -10    │   360   │    140    │   821    │    219    │  57310  │                │
│   12    │   -15    │   390   │    110    │   894    │    146    │  57208  │                │
│   13    │   -20    │   420   │    80     │    5     │     5     │   325   │      true      │
│   14    │   -25    │   435   │    65     │   966    │    74     │  40166  │                │
│   15    │   -30    │   445   │    55     │   989    │    51     │  38912  │                │
│   16    │   -35    │   465   │    35     │   998    │    42     │  21814  │                │
│   17    │   -40    │   465   │    35     │   1009   │    31     │  26027  │                │
│   18    │   -45    │   475   │    25     │   1016   │    24     │  18356  │                │
│   19    │   -50    │   480   │    20     │   1023   │    17     │  15840  │                │
└─────────┴──────────┴─────────┴───────────┴──────────┴───────────┴─────────┴────────────────┘
Loss per losing trade: 100%
┌─────────┬──────────┬─────────┬───────────┬──────────┬───────────┬─────────┬────────────────┐
│ (index) │ distance │ maxLoss │ maxProfit │ winCount │ lossCount │ balance │ unableToFinish │
├─────────┼──────────┼─────────┼───────────┼──────────┼───────────┼─────────┼────────────────┤
│    0    │    50    │   490   │    10     │   1024   │    16     │  3900   │                │
│    1    │    45    │   485   │    15     │   1019   │    21     │  6600   │                │
│    2    │    40    │   480   │    20     │   1010   │    30     │  7300   │                │
│    3    │    35    │   465   │    35     │   1002   │    38     │  18900  │                │
│    4    │    30    │   445   │    55     │   982    │    58     │  29700  │                │
│    5    │    25    │   425   │    75     │   964    │    76     │  41500  │                │
│    6    │    20    │   390   │    110    │   922    │    118    │  56900  │                │
│    7    │    15    │   340   │    160    │   856    │    184    │  75900  │                │
│    8    │    10    │   305   │    195    │   782    │    258    │  75300  │                │
│    9    │    5     │   260   │    240    │   649    │    391    │  55600  │                │
│   10    │    -5    │   325   │    175    │    4     │     6     │   250   │      true      │
│   11    │   -10    │   360   │    140    │    4     │     5     │   260   │      true      │
│   12    │   -15    │   390   │    110    │    5     │     5     │   100   │      true      │
│   13    │   -20    │   420   │    80     │    5     │     4     │   220   │      true      │
│   14    │   -25    │   435   │    65     │   966    │    74     │  32100  │                │
│   15    │   -30    │   445   │    55     │   989    │    51     │  33200  │                │
│   16    │   -35    │   465   │    35     │   998    │    42     │  16900  │                │
│   17    │   -40    │   465   │    35     │   1009   │    31     │  22400  │                │
│   18    │   -45    │   475   │    25     │   1016   │    24     │  15500  │                │
│   19    │   -50    │   480   │    20     │   1023   │    17     │  13800  │                │
└─────────┴──────────┴─────────┴───────────┴──────────┴───────────┴─────────┴────────────────┘
```
